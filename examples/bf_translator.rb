x = y = 0
code = [[]]
stack = []
append = ->str{ str.chars{ |c| code[y][x] = c; x += 1 } }
$<.read.chars do |char|
  case char
  when ?-
    append.call ":03--::\\"
    append.call "1-"
    append.call "1\\1-\\$"
  when ?+
    append.call ":03--::\\"
    append.call "01--"
    append.call "1\\1-\\$"
  when ?.
    append.call ":03--::\\"
    append.call ":,"
    append.call "1\\1-\\$"
  when ?,
    append.call ":02--"
    append.call "~ "
    append.call "1\\\\$"
  when ?>
    append.call "01--"
  when ?<
    append.call "1-:01--?@"
  when ?[
    t = x
    append.call "v            >1\\1-\\$"
    x = t
    stack.push y
    y = code.size
    code.push []
    append.call ">:03--::\\"
    append.call          "::/?^1\\1-\\$"
  when ?]
    y = stack.pop
    append.call ">"
  end
end
append.call "0@"
code.each{ |line| puts line.map{ |c| c || " " }.join }

__END__

$ echo "++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++.------.--------.>>+.>++." | ruby bf_translator.rb | tee /dev/tty | rasel
:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$v            >1\1-\$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >01--01--:03--::\:,1\1-\$01--:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\:,1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\:,1\1-\$:03--::\:,1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\:,1\1-\$01--01--:03--::\:,1\1-\$1-:01--?@:03--::\1-1\1-\$:03--::\:,1\1-\$1-:01--?@:03--::\:,1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\:,1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\:,1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\1-1\1-\$:03--::\:,1\1-\$01--01--:03--::\01--1\1-\$:03--::\:,1\1-\$01--:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\:,1\1-\$0@
                                                                                                                                                >:03--::\::/?^1\1-\$01--:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$v            >1\1-\$                                                                                                                                                                                                                                      >01--:03--::\01--1\1-\$01--:03--::\01--1\1-\$01--:03--::\1-1\1-\$01--01--:03--::\01--1\1-\$v            >1\1-\$         >1-:01--?@:03--::\1-1\1-\$
                                                                                                                                                                                                                                                >:03--::\::/?^1\1-\$01--:03--::\01--1\1-\$:03--::\01--1\1-\$01--:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$01--:03--::\01--1\1-\$:03--::\01--1\1-\$:03--::\01--1\1-\$01--:03--::\01--1\1-\$1-:01--?@1-:01--?@1-:01--?@1-:01--?@:03--::\1-1\1-\$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     >:03--::\::/?^1\1-\$1-:01--?@
Hello World!
